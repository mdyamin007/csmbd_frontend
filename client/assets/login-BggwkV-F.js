import{w as f,t as r,e as g,s as j}from"./utils-U4k8zN-U.js";import{r as w,u as L,j as s,L as N}from"./chunk-GNGMS2XR-BTyGsKOQ.js";import{c as v,a as c,F as y,d as C,L as l,e as m,I as d,E as p}from"./index.esm-BgvrQcmk.js";import{C as b,a as E,b as S,c as k,d as F,e as P,E as T}from"./api.actions-R6WKCUBF.js";import{B as D}from"./QueryClientProvider-Qv7QOnvw.js";import{u as M}from"./use-post.hook-BcJdfVOy.js";import{u as q}from"./hook-D_gVsVG3.js";import{s as B}from"./userSlice-DzMmQd_y.js";import"./mutation-D0SRK0Pe.js";import"./routes-B6W59PFx.js";const I=v().shape({email:c().email("Invalid email address").required("Email is required"),password:c().required("Password is required").min(6,"Password must be at least 6 characters")});function O({}){return[{title:"Login | CSMBD Content Management"},{name:"description",content:"Welcome to CSMBD Content Management System"}]}const Q=f(function(){const[i,o]=w.useState(!1),n=L(),u=q(),{mutate:x,isPending:t}=M({url:T.login(),options:{onSuccess:e=>{j({accessToken:e==null?void 0:e.accessToken,refreshToken:e==null?void 0:e.refreshToken}),u(B(e==null?void 0:e.user)),r("Login successful"),n("/dashboard")},onError:g}}),h=async e=>{o(!0);try{x({email:e.email,password:e.password}),r.success("Login successful"),n("/dashboard")}catch{r.error("Login failed")}finally{o(!1)}};return s.jsx("div",{className:"container mx-auto flex h-screen items-center justify-center",children:s.jsxs(b,{className:"w-full max-w-md",children:[s.jsxs(E,{children:[s.jsx(S,{className:"text-2xl",children:"Login"}),s.jsx(k,{children:"Enter your credentials to access your account"})]}),s.jsx(y,{initialValues:{email:"",password:""},validationSchema:I,onSubmit:h,children:({errors:e,touched:a})=>s.jsxs(C,{children:[s.jsxs(F,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"email",children:"Email"}),s.jsx(m,{as:d,id:"email",name:"email",type:"email",placeholder:"m@example.com",className:e.email&&a.email?"border-destructive":""}),s.jsx(p,{name:"email",component:"div",className:"text-sm text-destructive"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"password",children:"Password"}),s.jsx(m,{as:d,id:"password",name:"password",type:"password",className:e.password&&a.password?"border-destructive":""}),s.jsx(p,{name:"password",component:"div",className:"text-sm text-destructive"})]})]}),s.jsxs(P,{className:"flex flex-col space-y-4 mt-4",children:[s.jsx(D,{type:"submit",className:"w-full",disabled:i||t,children:i||t?"Logging in...":"Login"}),s.jsxs("div",{className:"text-center text-sm",children:["Don't have an account?"," ",s.jsx(N,{to:"/register",className:"underline underline-offset-4",children:"Register"})]})]})]})})]})})});export{Q as default,O as meta};
